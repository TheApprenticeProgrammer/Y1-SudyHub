SET GLOBAL SQL_MODE = CONCAT(@@SQL_MODE, ',ONLY_FULL_GROUP_BY'); 

SELECT li.ID_P, SUM(li.QTY) AS SUM
FROM SPJ li
GROUP BY li.ID_P
HAVING COUNT(*) > 3;
